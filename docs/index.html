<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Solutions for The Theoretical Biologist’s Toolbox</title>
  <meta name="description" content="<p>This is an online book of solutions for Marc Mangel’s The Theoretical
Biologist’s Toolbox.</p>" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Solutions for The Theoretical Biologist’s Toolbox" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is an online book of solutions for Marc Mangel’s The Theoretical
Biologist’s Toolbox.</p>" />
  <meta name="github-repo" content="henryhansen/theoretical-biologist-toolbox" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Solutions for The Theoretical Biologist’s Toolbox" />
  
  <meta name="twitter:description" content="<p>This is an online book of solutions for Marc Mangel’s The Theoretical
Biologist’s Toolbox.</p>" />
  

<meta name="author" content="Henry H. Hansen &amp; Daniel Greenberg" />


<meta name="date" content="2022-05-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="exercises-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Solutions for The Theoretical Biologist's Toolbox</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Exercises<span></span></a>
<ul>
<li><a href="index.html#exercise-1-2">Exercise 1 &amp; 2<span></span></a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#the-biology"><i class="fa fa-check"></i><b>1.0.1</b> The biology<span></span></a></li>
<li class="chapter" data-level="1.0.2" data-path="index.html"><a href="index.html#the-challenge"><i class="fa fa-check"></i><b>1.0.2</b> The challenge<span></span></a></li>
<li class="chapter" data-level="1.0.3" data-path="index.html"><a href="index.html#the-solution"><i class="fa fa-check"></i><b>1.0.3</b> The solution<span></span></a></li>
</ul></li>
<li><a href="index.html#exercise-3">Exercise 3<span></span></a>
<ul>
<li class="chapter" data-level="1.0.4" data-path="index.html"><a href="index.html#the-biology-1"><i class="fa fa-check"></i><b>1.0.4</b> The biology<span></span></a></li>
<li class="chapter" data-level="1.0.5" data-path="index.html"><a href="index.html#the-challenge-1"><i class="fa fa-check"></i><b>1.0.5</b> The challenge<span></span></a></li>
<li class="chapter" data-level="1.0.6" data-path="index.html"><a href="index.html#the-solution-1"><i class="fa fa-check"></i><b>1.0.6</b> The solution<span></span></a></li>
<li class="chapter" data-level="1.0.7" data-path="index.html"><a href="index.html#checking-our-work"><i class="fa fa-check"></i><b>1.0.7</b> Checking our work<span></span></a></li>
<li class="chapter" data-level="1.0.8" data-path="index.html"><a href="index.html#reflecting-on-the-biology"><i class="fa fa-check"></i><b>1.0.8</b> Reflecting on the biology<span></span></a></li>
</ul></li>
<li><a href="index.html#exercise-4">Exercise 4<span></span></a>
<ul>
<li class="chapter" data-level="1.0.9" data-path="index.html"><a href="index.html#the-biology-2"><i class="fa fa-check"></i><b>1.0.9</b> The biology<span></span></a></li>
<li class="chapter" data-level="1.0.10" data-path="index.html"><a href="index.html#the-challenge-2"><i class="fa fa-check"></i><b>1.0.10</b> The challenge<span></span></a></li>
<li class="chapter" data-level="1.0.11" data-path="index.html"><a href="index.html#the-solution-2"><i class="fa fa-check"></i><b>1.0.11</b> The solution<span></span></a></li>
<li class="chapter" data-level="1.0.12" data-path="index.html"><a href="index.html#checking-our-work-1"><i class="fa fa-check"></i><b>1.0.12</b> Checking our work<span></span></a></li>
<li class="chapter" data-level="1.0.13" data-path="index.html"><a href="index.html#reflecting-on-the-biology-1"><i class="fa fa-check"></i><b>1.0.13</b> Reflecting on the biology<span></span></a></li>
</ul></li>
<li><a href="index.html#exercise-5">Exercise 5<span></span></a>
<ul>
<li class="chapter" data-level="1.0.14" data-path="index.html"><a href="index.html#the-biology-3"><i class="fa fa-check"></i><b>1.0.14</b> The biology<span></span></a></li>
<li class="chapter" data-level="1.0.15" data-path="index.html"><a href="index.html#the-challenge-3"><i class="fa fa-check"></i><b>1.0.15</b> The challenge<span></span></a></li>
<li class="chapter" data-level="1.0.16" data-path="index.html"><a href="index.html#the-solution-3"><i class="fa fa-check"></i><b>1.0.16</b> The solution<span></span></a></li>
<li class="chapter" data-level="1.0.17" data-path="index.html"><a href="index.html#checking-our-work-2"><i class="fa fa-check"></i><b>1.0.17</b> Checking our work<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>2</b> Exercises<span></span></a>
<ul>
<li><a href="exercises-1.html#exercise-1-2-1">Exercise 1 &amp; 2<span></span></a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="exercises-1.html"><a href="exercises-1.html#the-biology-4"><i class="fa fa-check"></i><b>2.0.1</b> The biology<span></span></a></li>
<li class="chapter" data-level="2.0.2" data-path="exercises-1.html"><a href="exercises-1.html#the-challenge-4"><i class="fa fa-check"></i><b>2.0.2</b> The challenge<span></span></a></li>
<li class="chapter" data-level="2.0.3" data-path="exercises-1.html"><a href="exercises-1.html#the-solution-4"><i class="fa fa-check"></i><b>2.0.3</b> The solution<span></span></a></li>
<li class="chapter" data-level="2.0.4" data-path="exercises-1.html"><a href="exercises-1.html#checking-our-work-3"><i class="fa fa-check"></i><b>2.0.4</b> Checking our work<span></span></a></li>
<li class="chapter" data-level="2.0.5" data-path="exercises-1.html"><a href="exercises-1.html#reflecting-on-the-biology-2"><i class="fa fa-check"></i><b>2.0.5</b> Reflecting on the biology<span></span></a></li>
</ul></li>
<li><a href="exercises-1.html#exercise-3-4">Exercise 3 &amp; 4<span></span></a>
<ul>
<li class="chapter" data-level="2.0.6" data-path="exercises-1.html"><a href="exercises-1.html#the-biology-5"><i class="fa fa-check"></i><b>2.0.6</b> The biology<span></span></a></li>
<li class="chapter" data-level="2.0.7" data-path="exercises-1.html"><a href="exercises-1.html#the-challenge-5"><i class="fa fa-check"></i><b>2.0.7</b> The challenge<span></span></a></li>
<li class="chapter" data-level="2.0.8" data-path="exercises-1.html"><a href="exercises-1.html#the-solution-5"><i class="fa fa-check"></i><b>2.0.8</b> The solution<span></span></a></li>
<li class="chapter" data-level="2.0.9" data-path="exercises-1.html"><a href="exercises-1.html#checking-our-work-4"><i class="fa fa-check"></i><b>2.0.9</b> Checking our work<span></span></a></li>
<li class="chapter" data-level="2.0.10" data-path="exercises-1.html"><a href="exercises-1.html#reflecting-on-the-biology-3"><i class="fa fa-check"></i><b>2.0.10</b> Reflecting on the biology<span></span></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Solutions for The Theoretical Biologist’s Toolbox</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Solutions for The Theoretical Biologist’s Toolbox</h1>
<p class="author"><em>Henry H. Hansen &amp; Daniel Greenberg</em></p>
<p class="date"><em>2022-05-24</em></p>
</div>
<div id="exercises" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Exercises<a href="index.html#exercises" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="exercise-1-2" class="section level2 unnumbered hasAnchor">
<h2>Exercise 1 &amp; 2<a href="index.html#exercise-1-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<script type="text/x-mathjax-config">
MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
  MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
    cancel: ["Extension","cancel"],
    bcancel: ["Extension","cancel"],
    xcancel: ["Extension","cancel"],
    cancelto: ["Extension","cancel"]
  });
});
</script>
<blockquote>
<p><strong><em>Math Prerequisite:</em></strong> Algebra and Inequality Functions</p>
</blockquote>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="index.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div id="the-biology" class="section level3 hasAnchor" number="1.0.1">
<h3><span class="header-section-number">1.0.1</span> The biology<a href="index.html#the-biology" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The concept and the impact of the choices one makes, often gets taken for granted. In the ecological and evolutionary arena, choices govern many of the phenomenon we observe. An organism must use its resources in an effective manner to survive and reproduce. The collection of choices that an organism makes could be considered a strategy and when that strategy is passed on to future generations, we can start to see how generalist and specialist behaviors arise.</p>
<p>In the simplest arrangement, we could consider a single predator, say a wolf, that has two choices of prey, <span class="math inline">\(i\)</span>, where each type of prey has a distinct energy benefit, <span class="math inline">\(E\)</span>,for the predator . This energy benefit will depend on how long it takes to handle and consume the prey, <span class="math inline">\(h\)</span>. For example, the energy benefit of a wolf trying to catch a rabbit versus trying to catch a beaver. And will also depend on often the predator will encounter each prey type, <span class="math inline">\(\lambda\)</span>. Given these assumptions we could argue that the best prey items are the ones that give us the most amount of energy with the least amount of effort!</p>
<p>With this in mind let’s start by writing some of these down with labels.</p>
<p><span class="math display">\[
i \text{ indicates an index for prey (1 = 1st prey, 2 = 2nd prey)}
\\[10pt]
E_i = \text{net energy gain}
\\[10pt]
h_i = \text{handling and consumption time}
\\[10pt]
\lambda_i = \text{encounter rate of prey}
\\[10pt]
\frac{E_i}{h_i} = \text{prey value}
\]</span></p>
<p>In Marc’s book we assume that prey type 1 is more profitable than prey type 2. That means for now on we replace <span class="math inline">\(i\)</span> with 1. So if you were the predator and had to choose among prey items, would you only go after prey 1 or would you go after anything you encountered? The first way is the way of the specialist, while the second is the way of the generalist. The really exciting part is that we can figure out which strategy is more effective, at least from the energy perspective. But we still need a couple more pieces to figure this out.</p>
<p>First, the effectiveness of a strategy is dependent on how long we watch either approach so we should assume a long time period to better match what we might see in the wild. Now that we have this long time period <span class="math inline">\(T\)</span>, we have to break this into two categories, time spent searching, <span class="math inline">\(S\)</span>, and time spent handling prey after finding it, <span class="math inline">\(H\)</span>. Let’s put this relationship down.</p>
<p><span class="math display">\[
T = S + H = \text{ total time period is the combination of searching and handling time }
\]</span></p>
<p>Now take note that <span class="math inline">\(h\)</span> and <span class="math inline">\(H\)</span> are not the same.<span class="math inline">\(H\)</span> is just a placeholder, what we really want to do is to plug in our parameters from above. If <span class="math inline">\(S\)</span> is search time with no prey, <span class="math inline">\(H\)</span> must be the time spent handling any prey that we encountered after searching for it. We can just combine these by multiplying!</p>
<p><span class="math display">\[
H = h_1(\lambda S) = \text{total prey handling time after search and encounter}
\]</span></p>
<p>With these major pieces figured out we can put <span class="math inline">\(S\)</span> and <span class="math inline">\(H\)</span> back into our total time equation. This is super important because we can now rearrange this master equation to figure out the tradeoffs between our different strategies. Let me show you.</p>
<p><span class="math display">\[
T = S + H = S + h_1(\lambda S) \text{ master time equation with search and handling}
\\[10pt]
T = S(1 + h_1\lambda) \text{ master time equation simplified}
\\[10pt]
S = \frac{T}{h_1\lambda} \text{master search equation}
\]</span></p>
<p>All we need to do now is bring in the final piece of our puzzle, <span class="math inline">\(E\)</span>! Remember, <span class="math inline">\(E\)</span> is net energy for a prey type so the total net energy is going to be, <span class="math inline">\(E\)</span>, for every prey we encountered, <span class="math inline">\(\lambda\)</span>, for the entire search time <span class="math inline">\(S\)</span>. The rate at which this total net energy is acquired for a predator is just total net energy divided by time. In other words energy from consumed prey per unit of time.</p>
<p><span class="math display">\[
R_s = \frac{E_1\lambda_1S}{S(1+h_1\lambda)} = \text{energy rate for predator}
\\[10pt]
R_s = \frac{E_1\lambda_1}{1+h_1\lambda} = \text{energy rate for predator simplified (S cancels out)}
\]</span></p>
<p>Fantastic, we now have an equation for the specialist strategy that tells us exactly how much energy a predator gets for a time period when hunting prey type 1!</p>
</div>
<div id="the-challenge" class="section level3 hasAnchor" number="1.0.2">
<h3><span class="header-section-number">1.0.2</span> The challenge<a href="index.html#the-challenge" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So here comes the challenge! Now that we know what the specialist strategy looks like how can we figure out the generalist approach? And how do we compare the two? So for the first part we need to include prey type 2. And for comparing the models we need to show how the encounter rate for prey type 1 could govern strategy choice. In other words show that the specialist strategy yields a greater energy rate than the generalist strategy by solving for <span class="math inline">\(\lambda1\)</span>. Thankfully, Marc has given us what the final outcomes should look like for both problems.</p>
<p><span class="math display">\[
R_g = \frac{E_1\lambda_1+E_2\lambda_2}{1+h_1\lambda_1+h_2\lambda_2} = \text{Generalist strategy}
\\[10pt]
\lambda_1 &gt; \frac{E_2}{E_1h_2-E_2h_1} = \text{Specialist strategy advantage}
\]</span></p>
<center>
<strong>Produce an equation for the generalist strategy and show how the specialist strategy could be more effective because of encounter rate of prey type 1</strong>
</center>
</div>
<div id="the-solution" class="section level3 hasAnchor" number="1.0.3">
<h3><span class="header-section-number">1.0.3</span> The solution<a href="index.html#the-solution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="part-1-exercise-1.1" class="section level4 hasAnchor" number="1.0.3.1">
<h4><span class="header-section-number">1.0.3.1</span> Part 1 (Exercise 1.1)<a href="index.html#part-1-exercise-1.1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>So for the generalist strategy we just need to include prey type 2, therefore we can recycle many of the same terms and solve for the equation using a similar approach. Remember we want total energy gained for each species divided by total time.
<span class="math display">\[
\textsf{Create master time equation with both prey handling times}
\\[10pt]
T = S + H_1 + H_2
\\[10pt]
\textsf{Substitute the placeholder H with our equation for total prey handling time after search and encounter}
\\[10pt]
T = S + h_1(\lambda_1 S) + h_2(\lambda_2 S)
\\[10pt]
\textsf{Simplify equation by factoring out S}
\\[10pt]
T = S( 1 + h_1\lambda_1 + h_2\lambda_2)
\\[10pt]
\textsf{Solve for S}
\\[10pt]
S = \frac{T}{( 1 + h_1\lambda_1 + h_2\lambda_2)}
\\[10pt]
\textsf{Bring in total net energy for each prey using S and divide by total time}
\\[10pt]
R_g = \frac{E_1\lambda_1S + E_2\lambda_2S}{S( 1 + h_1\lambda_1 + h_2\lambda_2)}
\\[10pt]
\textsf{factor out S and cancel}
\\[10pt]
R_g = \frac{\cancel{S}(E_1\lambda_1 + E_2\lambda_2)}{\cancel{S}( 1 + h_1\lambda_1 + h_2\lambda_2)}
\\[10pt]
R_g = \frac{(E_1\lambda_1 + E_2\lambda_2)}{( 1 + h_1\lambda_1 + h_2\lambda_2)}
\]</span></p>
</div>
<div id="part-2-exercise-1.2" class="section level4 hasAnchor" number="1.0.3.2">
<h4><span class="header-section-number">1.0.3.2</span> Part 2 (Exercise 1.2)<a href="index.html#part-2-exercise-1.2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For this part we need to show that <span class="math inline">\(R_s&gt;R_g\)</span> by using <span class="math inline">\(lambda_1\)</span>. So let’s set these equations accordingly and solve for <span class="math inline">\(lambda_1\)</span>!</p>
<p><span class="math display">\[
R_s&gt;R_g \text{ is the same as } \frac{E_1\lambda_1}{1+h_1\lambda} &gt; \frac{E_1\lambda_1 + E_2\lambda_2}{ 1 + h_1\lambda_1 + h_2\lambda_2}
\\[10pt]
\textsf{start by multiplying both sides by the bottom of each fraction and cancel terms}
\\[10pt]
\frac{E_1\lambda_1( 1 + h_1\lambda_1 + h_2\lambda_2)\cancel{(1+h_1\lambda)}}{\cancel{1+h_1\lambda}} &gt; \frac{E_1\lambda_1 + E_2\lambda_2\cancel{( 1 + h_1\lambda_1 + h_2\lambda_2)} (1+h_1\lambda)}{\cancel{1 + h_1\lambda_1 + h_2\lambda_2}}
\\[10pt]
\textsf{after canceling it should look like this}
\\[10pt]
E_1\lambda_1( 1 + h_1\lambda_1 + h_2\lambda_2) &gt; (E_1\lambda_1 + E_2\lambda_2) (1+h_1\lambda_1)
\\[10pt]
\textsf{expand terms}
\\[10pt]
E_1\lambda_1 + E_1\lambda_1h_1\lambda_1 + E_1\lambda_1h_2\lambda_2 &gt; E_1\lambda_1 + E_2\lambda_2\ + E_1\lambda_1h_1\lambda_1+ E_2\lambda_2h_1\lambda_1
\\[10pt]
\textsf{cancel terms}
\\[10pt]
\cancel{E_1\lambda_1} + \cancel{E_1\lambda_1h_1\lambda_1} + E_1\lambda_1h_2\lambda_2 &gt; \cancel{E_1\lambda_1} + E_2\lambda_2\  + \cancel{E_1\lambda_1h_1\lambda_1} + E_2\lambda_2h_1\lambda_1
\\[10pt]
\textsf{bring all } \lambda_1 \textsf{ to the left side}
\\[10pt]
E_1\lambda_1h_2\lambda_2 - E_2\lambda_2h_1\lambda_1 &gt; E_2\lambda_2\
\\[10pt]
\textsf{factor out } \lambda_1
\\[10pt]
\lambda_1(E_1h_2\lambda_2 - E_2\lambda_2h_1) &gt; E_2\lambda_2\
\\[10pt]
\textsf{ and then divide and simplify by canceling } \lambda_2
\\[10pt]
\lambda_1 &gt; \frac{E_2}{E_1h_2-E_2h_1}
\]</span></p>
</div>
</div>
</div>
<div id="exercise-3" class="section level2 unnumbered hasAnchor">
<h2>Exercise 3<a href="index.html#exercise-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p><strong><em>Math Prerequisite:</em></strong> Algebra and Plane Geometry</p>
</blockquote>
<pre><code>## Warning: package &#39;fishualize&#39; was built under R version 4.1.3</code></pre>
<div id="the-biology-1" class="section level3 hasAnchor" number="1.0.4">
<h3><span class="header-section-number">1.0.4</span> The biology<a href="index.html#the-biology-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Marc introduces us to a new foraging model. In this scenario there is only type of food and they are evenly dispersed in patches throughout an area. This means that the travel time between each patch of food is the same. The predator must decide how long to stay in the patch before moving on to the next one. Marc calls this patch residence time, <span class="math inline">\(\tau\)</span>, the greek letter tau. He also describes the patches as exhaustible so the amount of energy gained at single patch naturally increases but becomes asymptotic over time. This kind of scenario would be quite similar to a bird flying between trees in an cherry orchard, eating all of the cherries at one tree, and then moving on to the next tree. So how do we model the relationship between energy and time spent at a patch? Marc provides two possibilities for this “energy gain” function, we will call this <span class="math inline">\(G(t)\)</span>.</p>
<p><span class="math display">\[
\tau \text{ is the time spent at a patch}
\\[10pt]
G(\tau) \text{ is the function for energy gain}
\\[10pt]
\]</span>
Below are the two options that Marc suggests to model this relationship.
<span class="math display">\[
G_1(\tau) = \frac{a\tau}{(b+\tau)} \text{ first gain function}
\\[10pt]
G_2(\tau) = \frac{a\tau^2}{(b+\tau^2)} \text{ second gain function}
\\[10pt]
\]</span></p>
</div>
<div id="the-challenge-1" class="section level3 hasAnchor" number="1.0.5">
<h3><span class="header-section-number">1.0.5</span> The challenge<a href="index.html#the-challenge-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<center>
<strong>Draw each gain function and explain what the individual parameters (a and b) represent</strong>
</center>
</div>
<div id="the-solution-1" class="section level3 hasAnchor" number="1.0.6">
<h3><span class="header-section-number">1.0.6</span> The solution<a href="index.html#the-solution-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Equations plotted using Desmos graphing calculator (<a href="https://www.desmos.com/calculator" class="uri">https://www.desmos.com/calculator</a>)</p>
<p align="center">
<img src="gifs/rate_gain_a_1-5_by_pt25.gif" />
<img src="gifs/rate_gain_b_1-5_by_pt25.gif" />
</p>
<p>Using the two models Marc suggested, <span class="math inline">\(G_1(\tau)\)</span>, the first equation, is in red and the second equation, <span class="math inline">\(G_2(\tau)\)</span> is in purple, we can see how these models change when the parameters “<span class="math inline">\(a\)</span>” (first gif) and “<span class="math inline">\(b\)</span>” (second gif) are adjusted. The first thing to notice is that both models arrive at an asymtote but the second model has a concave shape before arriving to an asymtote while the first model maintains a convex shape for all positive numbers. Another thing to notice is that the second model reaches asymptote at a faster rate.</p>
<p>Regarding the parameters Marc says the following: “Possible values for variables <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> are foraging costs and food abundance in the patches. Note that the same constants (<span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>) are used in the expression, but they have different meanings. Since we’ll be measuring gain in energy units, kilocalories, this implies that <span class="math inline">\(b\)</span> will be in units of time, minutes in <span class="math inline">\(G_1(\tau)\)</span> and minutes<span class="math inline">\(^2\)</span> in <span class="math inline">\(G_2(\tau)\)</span>.Variable <span class="math inline">\(a\)</span> will be in units of energy, kilocalories in <span class="math inline">\(G_1(\tau)\)</span> and kilocalories in <span class="math inline">\(G_2(\tau)\)</span>.”</p>
</div>
<div id="checking-our-work" class="section level3 hasAnchor" number="1.0.7">
<h3><span class="header-section-number">1.0.7</span> Checking our work<a href="index.html#checking-our-work" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While plotting the individual functions on paper (or a graphing calculator) is rather self-explanatory we could also show the same thing using R just for consistency.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="index.html#cb3-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">1</span> <span class="co"># parameter value for a</span></span>
<span id="cb3-2"><a href="index.html#cb3-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fl">0.5</span> <span class="co"># parameter value for b</span></span>
<span id="cb3-3"><a href="index.html#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="index.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span> </span>
<span id="cb3-5"><a href="index.html#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x) a<span class="sc">*</span>x<span class="sc">/</span>(b <span class="sc">+</span>x)) <span class="sc">+</span> <span class="co">#G1(t)</span></span>
<span id="cb3-6"><a href="index.html#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x) a<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(b <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="co">#G2(t)</span></span>
<span id="cb3-7"><a href="index.html#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-8"><a href="index.html#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Residence Time (t)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Gain, G(t)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>If we take it a step further we can also add the tangent line Marc was referring to in his book using the same equation in figure 1.3</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="index.html#cb4-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">1</span> <span class="co"># parameter value for a</span></span>
<span id="cb4-2"><a href="index.html#cb4-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">3</span> <span class="co"># parameter value for b is now changed to 3</span></span>
<span id="cb4-3"><a href="index.html#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="index.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># How do we figure out the slope for the tangent line?</span></span>
<span id="cb4-5"><a href="index.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#First assume Tau is 3 just like in Figure 1.3 so we are reproducing the same graph</span></span>
<span id="cb4-6"><a href="index.html#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Then add that point to the graph (-3,0) - remember that we are interpreting Tau as a negative here</span></span>
<span id="cb4-7"><a href="index.html#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Then increase slope until the line is tangent to the gain curve</span></span>
<span id="cb4-8"><a href="index.html#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="index.html#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="index.html#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>)), <span class="fu">aes</span>(x)) <span class="sc">+</span> <span class="co">#the data entry for x is also longer</span></span>
<span id="cb4-11"><a href="index.html#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x) a<span class="sc">*</span>x<span class="sc">/</span>(b <span class="sc">+</span>x)) <span class="sc">+</span> <span class="co">#G1(t)</span></span>
<span id="cb4-12"><a href="index.html#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="sc">-</span><span class="dv">3</span>, <span class="at">y=</span><span class="dv">0</span>), <span class="at">colour=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> <span class="co">#adding on the negative tau,0 point</span></span>
<span id="cb4-13"><a href="index.html#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>, <span class="at">intercept =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="co">#here is the tangent line added as just a guess</span></span>
<span id="cb4-14"><a href="index.html#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-15"><a href="index.html#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">20</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">+</span> <span class="co"># adjusting the graph to see everything</span></span>
<span id="cb4-16"><a href="index.html#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Residence Time (t)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Gain, G(t)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="reflecting-on-the-biology" class="section level3 hasAnchor" number="1.0.8">
<h3><span class="header-section-number">1.0.8</span> Reflecting on the biology<a href="index.html#reflecting-on-the-biology" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I think one of the main considerations one should grapple with is asking ourselves, how do predators know when to leave? In the original paper by Charnov, he mentions the following:</p>
<pre><code>The simple  tendency  for  a predator  to  remain  in  the  area where  it  was successful  has been  documented  for  birds (Tinbergen, Impekoven, and  Frank, 1967;  Krebs, MacRoberts, and Cullen, 1972);  fish (Beukema, 1968);  insects (Hafez,  1961; Fleschner, 1950; Laing, 1938; Mitchell, 1963; Dixon, 1959, 1970; Banks, 1957;  Richerson and  Borden, 1972;  Hassell and  May, 1973;  Murdie and  Hassell, 1973).  Even  unicellular predators  exhibit increased  frequency of turning following an  encounter with food particles, a  behavior pattern that results  in  a more  intensive search of  the  vicinity of  the  capture  (Fraenkel and Gunn, 1940; MacNab and  Koshland, 1972).</code></pre>
<p>I personally think that finding this kinds of fundamental relationships are becoming increasingly easier to investigate with the development of remote sensing and animal tracking technology. Of course, if one were to actually develop a study on this topic, they would soon realize that “patches” are not perfect little circles. Additionally the space between patches are not remotely consistent in the real world. Finding regions of the world that are untainted by the human enterprise certainly poses new challenges for investigating such relationships when so much has become altered. Imagine for example, a predatory fish that must navigate a now turbid and polluted lake with many dams in it’s streams, or a puma that hunts different herds of deer but must contend with highways and roads. The <em>marginal value</em> a predator gets by staying at a patch is likely not constant as the world it tries to persist in is constantly changing.</p>
</div>
</div>
<div id="exercise-4" class="section level2 unnumbered hasAnchor">
<h2>Exercise 4<a href="index.html#exercise-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p><strong><em>Math Prerequisite:</em></strong> Calculus and Power Rule</p>
</blockquote>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="index.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb6-2"><a href="index.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fishualize)</span></code></pre></div>
<div id="the-biology-2" class="section level3 hasAnchor" number="1.0.9">
<h3><span class="header-section-number">1.0.9</span> The biology<a href="index.html#the-biology-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Imagine you are a female salmon, and you want to have as many children as possible and hope they survive, how many eggs should you have and how big should they be? Well, this of course depends on a number of factors. For starters, the number of eggs you lay depends on how big your gonads are. Secondly, the size of your eggs influences their survival, the bigger the egg, the better their survival. So put another way, given that you have a limited size and that you want the maximum amount of eggs to survive, how big should the eggs be?</p>
<p>Let’s start by putting some of these ideas onto paper and with proper names.</p>
<p><span class="math display">\[
x = \text{mass of a single egg}
\\[10pt]
g = \text{mass of female gonads}
\\[10pt]
S() = \text{survival function}
\]</span>
Great! Now how do we link the two? Thankfully, Einum and Fleming (2000) have figured out an interesting relationship for us. Based on their experiment they found the following relationship for egg survival.
<span class="math display">\[
S(x) = 1 - (\frac{x_{min}}{x})^{a}
\]</span>
This means that given a minimum egg size <span class="math inline">\(x_{min}\)</span> and some scaling exponent <span class="math inline">\(a\)</span>, we can calculate the survival of an egg. That’s pretty cool! In there experiments the specific value for <span class="math inline">\(x_{min}\)</span> was 0.0676 g and for <span class="math inline">\(a\)</span> was 1.5066. Let’s see what that looks like on a graph</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="index.html#cb7-1" aria-hidden="true" tabindex="-1"></a>xmin <span class="ot">&lt;-</span> <span class="fl">0.0676</span> <span class="co">#x_min</span></span>
<span id="cb7-2"><a href="index.html#cb7-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fl">1.5066</span> <span class="co">#a</span></span>
<span id="cb7-3"><a href="index.html#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="index.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#survival function</span></span>
<span id="cb7-5"><a href="index.html#cb7-5" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb7-6"><a href="index.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span>(xmin<span class="sc">/</span>x)<span class="sc">^</span>a <span class="co">#the survival function</span></span>
<span id="cb7-7"><a href="index.html#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (s <span class="sc">&lt;</span> <span class="dv">0</span>) { <span class="co"># a rule that turns impossible negative survivals</span></span>
<span id="cb7-8"><a href="index.html#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)      <span class="co"># to 0</span></span>
<span id="cb7-9"><a href="index.html#cb7-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-10"><a href="index.html#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(s)</span>
<span id="cb7-11"><a href="index.html#cb7-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-12"><a href="index.html#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="index.html#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#create a dataset based off the function</span></span>
<span id="cb7-14"><a href="index.html#cb7-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="fl">0.5</span>,<span class="fl">0.01</span>) <span class="co"># produce a range of egg sizes</span></span>
<span id="cb7-15"><a href="index.html#cb7-15" aria-hidden="true" tabindex="-1"></a>surv <span class="ot">=</span> <span class="fu">sapply</span>(x, s) <span class="co"># apply the survival function to the egg sizes</span></span>
<span id="cb7-16"><a href="index.html#cb7-16" aria-hidden="true" tabindex="-1"></a>egg_surv <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x,surv) <span class="co">#combine the data</span></span>
<span id="cb7-17"><a href="index.html#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="index.html#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the data</span></span>
<span id="cb7-19"><a href="index.html#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(egg_surv, <span class="fu">aes</span>(x,surv))<span class="sc">+</span></span>
<span id="cb7-20"><a href="index.html#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb7-21"><a href="index.html#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-22"><a href="index.html#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Egg size-grams&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Survival&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="_main_files/figure-html/unnamed-chunk-6-1.png" alt="Plot of egg size in relation to survival of eggs" width="672" />
<p class="caption">
Figure 1.1: Plot of egg size in relation to survival of eggs
</p>
</div>
</div>
<div id="the-challenge-2" class="section level3 hasAnchor" number="1.0.10">
<h3><span class="header-section-number">1.0.10</span> The challenge<a href="index.html#the-challenge-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we know what the survival function looks like let’s try to link this to our “How big should the eggs be?” question. Let’s call this question, reproductive success <span class="math inline">\(R()\)</span>. But what should we put in this function. We know that gonad mass <span class="math inline">\(g\)</span> is going to be much larger than our egg mass <span class="math inline">\(x\)</span> so if we divide <span class="math inline">\(g\)</span> by <span class="math inline">\(x\)</span>, that will tell us how many eggs we have.</p>
<p><span class="math display">\[
\text{number of eggs} = \frac{g}{x}
\]</span>
So if we want to figure out reproductive success R(), we just need to multiply the number of eggs by the survival function. This looks like this.</p>
<p><span class="math display">\[
R(g,x) = \frac{g}{x}S(x)=\frac{g}{x}1 - (\frac{x_{min}}{x})^{a}
\]</span></p>
<p>And a graph of the reproductive success function looks like this.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="index.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reproductive success function</span></span>
<span id="cb8-2"><a href="index.html#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="index.html#cb8-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="cf">function</span>(g,x) {</span>
<span id="cb8-4"><a href="index.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> (g<span class="sc">/</span>x)<span class="sc">*</span><span class="fu">s</span>(x) <span class="co">#here is our reproductive success function</span></span>
<span id="cb8-5"><a href="index.html#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-6"><a href="index.html#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="index.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming our female salmon gonads weighs 450 grams, we can just add that to the previous data</span></span>
<span id="cb8-8"><a href="index.html#cb8-8" aria-hidden="true" tabindex="-1"></a>egg_surv<span class="sc">$</span>female <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">450</span>,<span class="fu">length</span>(egg_surv<span class="sc">$</span>x))</span>
<span id="cb8-9"><a href="index.html#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="index.html#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we can calculate the corresponding reproductive success</span></span>
<span id="cb8-11"><a href="index.html#cb8-11" aria-hidden="true" tabindex="-1"></a>repro <span class="ot">=</span> <span class="fu">mapply</span>(r, egg_surv<span class="sc">$</span>female, <span class="at">x =</span> egg_surv<span class="sc">$</span>x)</span>
<span id="cb8-12"><a href="index.html#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="index.html#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># attach to our data</span></span>
<span id="cb8-14"><a href="index.html#cb8-14" aria-hidden="true" tabindex="-1"></a>egg_surv<span class="sc">$</span>repro <span class="ot">&lt;-</span> repro</span>
<span id="cb8-15"><a href="index.html#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="index.html#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co"># and plot it!</span></span>
<span id="cb8-17"><a href="index.html#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="index.html#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(egg_surv, <span class="fu">aes</span>(x,repro))<span class="sc">+</span></span>
<span id="cb8-19"><a href="index.html#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb8-20"><a href="index.html#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-21"><a href="index.html#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Egg size-grams&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Reproductive Success -R(450,x)&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="_main_files/figure-html/unnamed-chunk-7-1.png" alt="Reproductive success plot in relation to egg size for a female salmon with 450 g gonads" width="672" />
<p class="caption">
Figure 1.2: Reproductive success plot in relation to egg size for a female salmon with 450 g gonads
</p>
</div>
<p>So here comes the challenge! Now that we know what the reproductive success looks like how can we figure out the optimal egg size for our female salmon? If you don’t remember your math techniques, it’s ok! One thing we could do is to take the derivative of the reproductive success function. <em>Remember, a derivative tells us the amount by which a function is changing at one given point.</em> This will tell us how reproductive success changes instantaneously. The place where the change is equal to 0 is our optimum. So, we could solve that equation for x when it’s equal to 0 and that will tell us exactly where the optimum is.</p>
<center>
<strong>Take the derivative of R(g,x) with respect to x, and solve for x when R’ is = 0.</strong>
</center>
</div>
<div id="the-solution-2" class="section level3 hasAnchor" number="1.0.11">
<h3><span class="header-section-number">1.0.11</span> The solution<a href="index.html#the-solution-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="simplify-the-equation" class="section level4 hasAnchor" number="1.0.11.1">
<h4><span class="header-section-number">1.0.11.1</span> Simplify the equation<a href="index.html#simplify-the-equation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The first thing we can do is group together our constants in the survival function, <span class="math inline">\(a\)</span> and <span class="math inline">\(x_{min}\)</span>, that way we don’t have to wrestle with them when we are doing our calculus. For simplicity we will define <span class="math inline">\((x_{min})^a=c\)</span>. That will mean that our constants, <span class="math inline">\(c\)</span>, includes both of these terms. So what does our equation look like now?</p>
<p><span class="math display">\[
S(x) = 1 - (\frac{x_{min}}{x})^{a}
\\[10pt]
(x_{min})^a=c
\\[10pt]
S(x) = 1-cx^{-a}
\]</span></p>
<p>Next, let’s put this back into our reproductive success function.</p>
<p><span class="math display">\[
R(g,x) = \frac{g}{x}1-cx^{-a}
\]</span>
Now before we take the derivative to the reproductive success function, we want to move <span class="math inline">\(g\)</span> to the other side. This will change the function so we are only optimizing for the input <span class="math inline">\(x\)</span>.</p>
<p><span class="math display">\[
R(g,x) = \frac{g}{x}1-cx^{-a}
\\[10pt]
\frac{R(x)}{g} = \frac{1}{x}(1-cx^{-a})
\\[10pt]
\frac{R(x)}{g} = x^{-1}-cx^{-a-1}
\]</span>
Now we can take the derivative!</p>
</div>
<div id="take-the-derivative" class="section level4 hasAnchor" number="1.0.11.2">
<h4><span class="header-section-number">1.0.11.2</span> Take the derivative<a href="index.html#take-the-derivative" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
\frac{d}{dx}(\frac{1}{x}-cx^{-a-1})
\\[10pt]
\textsf{Differentiate the sum term by term and factor out constants}
\\[10pt]
\frac{d}{dx}(\frac{1}{x})-c(\frac{d}{dx}(x^{-a-1}))
\\[10pt]
\textsf{Use the power rule } \frac{d}{dx}(x^n) = n x^{(n - 1)}, \textsf{where } n = - 1.
\\[10pt]
\begin{aligned}
&amp;\frac{d}{dx}\left(\frac{1}{x}\right)=\frac{d}{dx}\left(x^{-1}\right)=-x^{-2}: \\
&amp;=-c\left(\frac{d}{dx}\left(x^{-1-a}\right)\right)+-\frac{1}{x^{2}}
\end{aligned}
\\[10pt]
\textsf{Use the power rule, }\frac{d}{dx}\left(x^{n}\right)=n x^{n-1}\textsf{, where } n=-a-1
\\
\begin{aligned}
&amp;\frac{d}{dx}\left(x^{-a-1}\right)=(-a-1) x^{-a-2} \\
&amp;=-\frac{1}{x^{2}}-\left((-1-a) x^{-2-a}\right) c
\end{aligned}
\\[10pt]
\textsf{Here is the final derivative}
=-\frac{1}{x^{2}}-\left((-1-a) x^{-2-a}\right) c
\]</span></p>
</div>
<div id="solve-for-x" class="section level4 hasAnchor" number="1.0.11.3">
<h4><span class="header-section-number">1.0.11.3</span> Solve for x<a href="index.html#solve-for-x" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now we take the derivative, equate it to 0, and solve for x.</p>
<p><span class="math display">\[
-\frac{1}{x^{2}}-\left((-1-a) x^{-2-a}\right) c = 0
\\[10pt]
\textsf{Move over the first term by using addition}
\\[10pt]
-\left((-1-a) x^{-2-a}\right) c = \frac{1}{x^{2}}
\\[10pt]
\textsf{Divide by the powered term}
\\[10pt]
\frac{-\left((-1-a) x^{-2-a}\right)c}{x^{-2-a}}=\frac{x^{-2}}{x^{-2-a}}
\\[10pt]
c(a+1)=x^a
\\[10pt]
\textsf{take the }a \textsf{ root of x}
\\[10pt]
x=\sqrt[a]{c(a+1)}
\]</span></p>
<p>Finally, we have figured out how to calculate our optimum! This should tell us what our egg size should be!</p>
</div>
</div>
<div id="checking-our-work-1" class="section level3 hasAnchor" number="1.0.12">
<h3><span class="header-section-number">1.0.12</span> Checking our work<a href="index.html#checking-our-work-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s test this equation and see if we get close to our expected answer. Remember, we want to find the optimum egg size. According to the reproductive success graph we should expect an egg size around 0.12 grams. Is that what we get when we plug it into R?</p>
<p>A quick side note, remember <span class="math inline">\(c = (x_{min})^a\)</span> so those constants need to come back into our calculation!</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="index.html#cb9-1" aria-hidden="true" tabindex="-1"></a> (xmin<span class="sc">^</span>a<span class="sc">*</span>(a<span class="sc">+</span><span class="dv">1</span>))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>a)</span></code></pre></div>
<pre><code>## [1] 0.124405</code></pre>
<p>Perfect, our calculation of 0.124 grams is exactly where we expected it!</p>
</div>
<div id="reflecting-on-the-biology-1" class="section level3 hasAnchor" number="1.0.13">
<h3><span class="header-section-number">1.0.13</span> Reflecting on the biology<a href="index.html#reflecting-on-the-biology-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To summarize, we figured out how egg survival and reproductive success of salmon can be influenced by the size of the egg. When we combine these two ideas together, we were able to figure out what is the ideal reproductive strategy for female salmon of a given size. If you were to go out in the cold waters of Sweden when the salmon are spawning and you managed to catch some females over a range of sizes, and thus different gonad sizes, and then tracked the egg survival you would get something like the following. The red line is the optimum egg value we calculated in relation to the different reproductive success outcomes given a range of female sizes and egg sizes.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="index.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming our female salmon gonads weigh from 400 to 500 grams</span></span>
<span id="cb11-2"><a href="index.html#cb11-2" aria-hidden="true" tabindex="-1"></a>females <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">300</span>,<span class="dv">600</span>,<span class="dv">1</span>)</span>
<span id="cb11-3"><a href="index.html#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="index.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we create placeholder values for all the different egg sizes we are interested in</span></span>
<span id="cb11-5"><a href="index.html#cb11-5" aria-hidden="true" tabindex="-1"></a>sweden <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">all_females =</span> <span class="fu">rep</span>(females,<span class="at">each =</span><span class="fu">length</span>(egg_surv<span class="sc">$</span>x)),</span>
<span id="cb11-6"><a href="index.html#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="at">all_eggs =</span> <span class="fu">rep</span>(x,<span class="at">times=</span><span class="fu">length</span>(females)))</span>
<span id="cb11-7"><a href="index.html#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="index.html#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Now we can calculate the corresponding reproductive success</span></span>
<span id="cb11-9"><a href="index.html#cb11-9" aria-hidden="true" tabindex="-1"></a>sweden<span class="sc">$</span>repro <span class="ot">=</span> <span class="fu">mapply</span>(r, sweden<span class="sc">$</span>all_females, <span class="at">x =</span> sweden<span class="sc">$</span>all_eggs)</span>
<span id="cb11-10"><a href="index.html#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="index.html#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># and plot it!</span></span>
<span id="cb11-12"><a href="index.html#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sweden, <span class="fu">aes</span>(all_eggs,repro, <span class="at">color=</span><span class="fu">factor</span>(all_females)))<span class="sc">+</span></span>
<span id="cb11-13"><a href="index.html#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb11-14"><a href="index.html#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb11-15"><a href="index.html#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.124</span>,<span class="at">color =</span> <span class="st">&quot;red&quot;</span>,<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb11-16"><a href="index.html#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_fishape</span>(<span class="at">family =</span> <span class="st">&quot;Salmonidae&quot;</span>,</span>
<span id="cb11-17"><a href="index.html#cb11-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">option =</span> <span class="st">&quot;Oncorhynchus_nerka&quot;</span>, <span class="co">#Technically, this is the wrong species but close enough :) </span></span>
<span id="cb11-18"><a href="index.html#cb11-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">xmin =</span> <span class="fl">0.3</span>,</span>
<span id="cb11-19"><a href="index.html#cb11-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">xmax =</span> <span class="fl">0.5</span>,</span>
<span id="cb11-20"><a href="index.html#cb11-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">ymin =</span> <span class="dv">2000</span>,</span>
<span id="cb11-21"><a href="index.html#cb11-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">ymax =</span> <span class="dv">3000</span>,</span>
<span id="cb11-22"><a href="index.html#cb11-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="fu">fish</span>(<span class="at">option =</span> <span class="st">&quot;Oncorhynchus_nerka&quot;</span>, <span class="at">n =</span> <span class="dv">4</span>)[<span class="dv">2</span>],</span>
<span id="cb11-23"><a href="index.html#cb11-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb11-24"><a href="index.html#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb11-25"><a href="index.html#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Egg size - grams&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Reproductive Success - R(300:600,x)&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Gonad Weight-grams&quot;</span>)<span class="sc">+</span> </span>
<span id="cb11-26"><a href="index.html#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
</div>
<div id="exercise-5" class="section level2 unnumbered hasAnchor">
<h2>Exercise 5<a href="index.html#exercise-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p><strong><em>Math Prerequisite:</em></strong> Calculus, Quotient Rule, Chain Rule, and Quadratic Formula</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="index.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb12-2"><a href="index.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span></code></pre></div>
<div id="the-biology-3" class="section level3 hasAnchor" number="1.0.14">
<h3><span class="header-section-number">1.0.14</span> The biology<a href="index.html#the-biology-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This exercise is focused on reproduction strategies, specifically concerning parasitic wasps. As Marc mentioned, these wasps have a haplo-diploid system where males comes from unfertilized eggs and females come from fertilized eggs. Unless you are the unfortunate organism chosen as a host, there is an interesting theoretical question to consider. That is, what kind of sex ratio should we expect when competing reproductive strategies are at play? Here, presents this question under the theory of the “unbeatable” sex ratio originally published by Hamilton. I would strongly encourage reading this good overview of the topic - <a href="https://www.cell.com/current-biology/comments/S0960-9822(17)30578-X" class="uri">https://www.cell.com/current-biology/comments/S0960-9822(17)30578-X</a></p>
<p>But concerning Marc’s exercise he presents the following premise, an unbeatable sex ratio exists if the fitness of a “mutant” strategy</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="index.html#cb13-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="cf">function</span>(r, rs, E, N) E<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">+</span>E<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>((<span class="dv">1</span><span class="sc">-</span>r)<span class="sc">+</span>N<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>rs))<span class="sc">*</span>(r<span class="sc">/</span>(r<span class="sc">+</span>N<span class="sc">*</span>rs))</span>
<span id="cb13-2"><a href="index.html#cb13-2" aria-hidden="true" tabindex="-1"></a>E <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb13-3"><a href="index.html#cb13-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb13-4"><a href="index.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># r = 0.5</span></span>
<span id="cb13-5"><a href="index.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rs = 0.5</span></span>
<span id="cb13-6"><a href="index.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fit(r,rs,E,N)</span></span>
<span id="cb13-7"><a href="index.html#cb13-7" aria-hidden="true" tabindex="-1"></a>r_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb13-8"><a href="index.html#cb13-8" aria-hidden="true" tabindex="-1"></a>rs_y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by=</span>.<span class="dv">1</span>)</span>
<span id="cb13-9"><a href="index.html#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="index.html#cb13-10" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">mapply</span>(fit, <span class="fu">list</span>(r_x), rs_y, E, N)</span>
<span id="cb13-11"><a href="index.html#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="index.html#cb13-12" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="dv">9</span>, <span class="at">name =</span> <span class="st">&quot;Spectral&quot;</span>)</span>
<span id="cb13-13"><a href="index.html#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">8</span>), <span class="at">xpd=</span><span class="cn">TRUE</span>)</span>
<span id="cb13-14"><a href="index.html#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(r_x, res, <span class="at">col=</span>cols, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">&quot;Mutant individual’s fraction of sons&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Fitness&quot;</span>)</span>
<span id="cb13-15"><a href="index.html#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;right&quot;</span>,  <span class="at">inset =</span> <span class="fu">c</span>(<span class="sc">-</span> <span class="fl">0.35</span>, <span class="dv">0</span>), <span class="at">legend=</span>rs_y, <span class="at">title=</span><span class="st">&quot;Normal individual’s </span><span class="sc">\n</span><span class="st"> fraction of sons&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span>cols, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="the-challenge-3" class="section level3 hasAnchor" number="1.0.15">
<h3><span class="header-section-number">1.0.15</span> The challenge<a href="index.html#the-challenge-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="the-solution-3" class="section level3 hasAnchor" number="1.0.16">
<h3><span class="header-section-number">1.0.16</span> The solution<a href="index.html#the-solution-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="the-first-part-is-to-take-the-derivative-to-the-fitness-equation-with-respect-to-r" class="section level4 hasAnchor" number="1.0.16.1">
<h4><span class="header-section-number">1.0.16.1</span> The first part is to take the derivative to the fitness equation with respect to <span class="math inline">\(r\)</span><a href="index.html#the-first-part-is-to-take-the-derivative-to-the-fitness-equation-with-respect-to-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
\\[10pt]
W\left(r, r^{*}\right)=E^{2}(1-r)+E^{2}\left\{(1-r)+N\left(1-r^{*}\right)\right\}\left[\frac{r}{r+N r^{*}}\right] = \text{Fitness Equation}
\\[10pt]
\textsf{Move the } E^2 \textsf{ term to the left to make our function proportional to eggs (just makes the calculus easier) and distribute last term}
\\[10pt]
\frac{W\left(r, r^{*}\right)}{E^{2}}=(1-r)+\frac{r(1-r)}{r+N r^{*}}+\frac{r N\left(1-r^{*}\right)}{r+N r^{*}}
\\[10pt]
\textsf{take the derivative with respect to r}
\\[10pt]
\frac{d}{dr}(1-r) = 0-1 \textsf{ derivative of the first term}
\\[10pt]
\textsf{ for the second term we need to use the quotient rule } \frac{d}{d r}\left(\frac{u}{v}\right)=\frac{v \frac{d u}{d r}-u \frac{d v}{d r}}{v^{2}} \text {, where } u=r(1-r) \text { and } v=r+Nr^*
\\[10pt]
\frac{d}{dr}(\frac{r(1-r)}{r+N r^{*}}) = \frac{(r+Nr^*)(\frac{d}{dr}r(1-r))-r(1-r)(\frac{d}{dr}(r+Nr^*))}{(r+Nr^*)^2}
\\[10pt]
\textsf{take the derivatives for the components in the numerator by simplifyling the first one and taking the derivative}
\\[10pt]
\frac{d}{dr}r(1-r) = \frac{d}{dr}r-r^2= 1-2r
\\[10pt] \textsf{ and }
\\[10pt]
\frac{d}{dr}(r+Nr^*)) = 1 + 0
\\[10pt]
\textsf{before we jump to the last term let&#39;s simplify what we have so far}
-1+\frac{(r+Nr^*)(1-2r)-r(1-r)(1)}{(r+Nr^*)^2} + \frac{d}{dr}(\frac{r N\left(1-r^{*}\right)}{r+N r^{*}})
\\[10pt]
\textsf{to take the derivative of the final term we pull out the constants and apply the quotient rule again}
\\[10pt]
(1-r^*)N\frac{d}{dr}(\frac{r}{r+Nr^*}) = (1-r^*)N\frac{(r+Nr^*)(\frac{d}{dr}r)-r(\frac{d}{dr}(r+Nr^*))}{(r+Nr^*)^2}
\\[10pt]
\textsf{since we know what the derivative of }r \textsf{ and } r+Nr^* \textsf{ is from the previous quotient rule the final derivative of the term is}
\\[10pt]
(1-r^*)N\frac{(r+Nr^*)-r}{(r+Nr^*)^2}
\\[10pt]
\textsf{so if we put all the terms together for our final derivative and simplify the ugly looking second term we get}
\\[10pt]
-1+\frac{-r^2+Nr^*-2rNr^*}{(r+Nr^*)^2} + (1-r^*)N\frac{r+Nr^*-r}{(r+Nr^*)^2}
\]</span></p>
</div>
<div id="the-second-part-is-to-substitute-r-for-r-and-simplify" class="section level4 hasAnchor" number="1.0.16.2">
<h4><span class="header-section-number">1.0.16.2</span> The second part is to substitute <span class="math inline">\(r\)</span> for <span class="math inline">\(r^*\)</span> and simplify<a href="index.html#the-second-part-is-to-substitute-r-for-r-and-simplify" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
\textsf{so let&#39;s start by replacing all the } r \textsf{ with } r^*
\\[10pt]
-1+\frac{-r^2+Nr^*-2rNr^*}{(r+Nr^*)^2} + (1-r^*)N\frac{r+Nr^*)-r}{(r+Nr^*)^2} \textsf{ becomes}
\\[20pt]
-1+\frac{-r^{*2}+Nr^*-2r^*Nr^*}{(r^*+Nr^*)^2} + (1-r^*)N\frac{r^*+Nr^*-r^*}{(r^*+Nr^*)^2}
\\[10pt]
\textsf{let&#39;s start by simplifying the leading factor in the 3rd term and combine like terms}
\\[10pt]
-1+\frac{-r^{*2}+Nr^*-2r^*Nr^*+N^2r^*(1-r^*)}{(r^*+Nr^*)^2}
\\[10pt]
\textsf{move 1 and the denominator to the other side and start simplfying things}
\\[10pt]
(r^*+Nr^*)^2 = -r^{*2}+Nr^*-2r^*Nr^*+N^2r^*(1-r^*) \textsf{ which is the same as }
\\[10pt]
r^{*2}+2Nr^{*2}+N^2r^{*2}= -r^{*2}+Nr^*-2Nr^{*2}+N^2r^*-N^2r^{*2}
\\[10pt]
\textsf{the important thing to to notice is we can combine all the terms now}
\\[10pt]
-2r^{*2}+Nr^*-4Nr^{*2}+N^2r^*-2N^2r^{*2}
\\[10pt]
\textsf{now we can factor out like variables}
\\[10pt]
r^*(N + N^2)+r^{*2}(-2-4N-2N^2)
\\[10pt]
\textsf{now we rearrange so it can be used in the quadratic formula}
\\[10pt]
-2(N+1)^2r^{*2} + (N(N+1))r^* + 0
\]</span></p>
</div>
<div id="the-final-part-is-to-plug-in-the-equation-into-the-quadratic-formula" class="section level4 hasAnchor" number="1.0.16.3">
<h4><span class="header-section-number">1.0.16.3</span> The final part is to plug in the equation into the quadratic formula<a href="index.html#the-final-part-is-to-plug-in-the-equation-into-the-quadratic-formula" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
\textsf{The quadratic formula is the following: }
x=\frac{-b\pm\sqrt{b^2-4ac}}{2a}
\\[10pt]
\textsf{plug in the equation components}
\\[10pt]
r^{*}=\frac{-N(N+1) \pm \sqrt{(N(N+1))^{2}}}{2\left(-2(N+1)^{2}\right)}
\\[20pt]
\textsf{and solve}
\\[10pt]
r^{*}=\frac{-2 N(N+1)}{2\left(-2(N+1)^{2}\right)}
\\[20pt]
\textsf{and simplify}
\\[10pt]
r^{*}=\frac{N}{2(N+1)}
\]</span></p>
</div>
</div>
<div id="checking-our-work-2" class="section level3 hasAnchor" number="1.0.17">
<h3><span class="header-section-number">1.0.17</span> Checking our work<a href="index.html#checking-our-work-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This was a beast of an exercise. There were so many steps, lots of ways to make mistakes, and a ridiculous amount of simplifying to keep track of everything. And even if you didn’t make it to the end, take a moment to be proud of your attempt. Science is one of those disciplines that is both a blessing and a curse in that the only answers you get are the ones you find yourself. Being thorough is just one piece of the scientific enterprise that I definitely felt was highlighted with this exercise. Much more would be needed to develop a publication so it’s good practice to get acquainted with persistence now.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="exercises-1.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
